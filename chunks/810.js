"use strict";(self.webpackChunkobstacle_component=self.webpackChunkobstacle_component||[]).push([[810],{90810:(e,t,i)=>{i.r(t),i.d(t,{previewCIMSymbol:()=>m});var n=i(95550),l=i(95215),o=i(11764),r=i(60789),s=i(83773),a=i(5840);const h=new o.CIMSymbolRasterizer(null,!0),c=(0,n.Wz)(s.b_.size),u=(0,n.Wz)(s.b_.maxSize),y=(0,n.Wz)(s.b_.lineWidth);async function m(e,t={}){const{node:i,opacity:s,symbolConfig:m}=t,d="object"==typeof m&&"isSquareFill"in m&&m.isSquareFill,f=t.cimOptions||t,g=f.geometryType||(0,r.JW)(e?.data?.symbol),w=function(e){const t=e?.size;return"number"==typeof t?{width:t,height:t}:{width:null!=t&&"object"==typeof t&&"width"in t?t.width:null,height:null!=t&&"object"==typeof t&&"height"in t?t.height:null}}(t),{feature:p,fieldMap:b}=f;if(null==w.width||null==w.height){const t=await l.E0.resolveSymbolOverrides(e.data,p,null,b,g);if(!t)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:t},e.data.primitiveOverrides=null;const i=[];l.B$.fetchResources(t,h.resourceManager,i),i.length>0&&await Promise.all(i);const{width:n,height:o}=l.B$.getEnvelope(t,null,h.resourceManager);w.width="esriGeometryPolygon"===g?c:"esriGeometryPolyline"===g?y:null!=n&&isFinite(n)?Math.min(n,u):c,w.height="esriGeometryPolygon"===g?c:null!=o&&isFinite(o)?Math.max(Math.min(o,u),1):c}const M=await h.rasterizeCIMSymbolAsync(e,p,w,d||"esriGeometryPolygon"!==g?o.GeometryStyle.Preview:o.GeometryStyle.Legend,b,g);if(!M)return null;const{width:S,height:v}=M,C=document.createElement("canvas");C.width=S,C.height=v,C.getContext("2d").putImageData(M,0,0);const z=(0,n.F2)(w.width),F=(0,n.F2)(w.height),G=new Image(z,F);G.src=C.toDataURL(),null!=s&&(G.style.opacity=`${s}`);let I=G;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:z,height:F,src:G.src},fill:null,stroke:null,offset:[0,0]};I=(0,a.w)([[e]],[z,F],{effectView:t.effectView})}return i&&I&&i.appendChild(I),I}}}]);