"use strict";(self.webpackChunkobstacle_component=self.webpackChunkobstacle_component||[]).push([[10],{18486:(e,t,n)=>{n.d(t,{Hq:()=>F,Mk:()=>d,P_:()=>Z,Qp:()=>j,VO:()=>S,_D:()=>R,kZ:()=>A,kr:()=>B,nF:()=>_,tB:()=>G,ut:()=>L,zD:()=>v}),n(91957);var i,r,s=n(70375),a=n(61681),l=n(17321),o=n(96926),c=n(90472),u=n(91772),p=n(67666),h=n(89542),f=n(14685);function d(e,t,n){return!(0,c.Up)(e,t,n)}function m(e,t,n){const i=d(e,t,n);if(i&&!(0,c.kR)())throw new s.Z("rasterprojectionhelper-project","projection engine is not loaded");return i}(r=i||(i={}))[r.None=0]="None",r[r.North=1]="North",r[r.South=2]="South",r[r.Both=3]="Both";const y=(e,t,n,i=0)=>{if(1===n[0])return[0,0];let r=1,s=-1,a=1,l=-1;for(let t=0;t<e.length;t+=2)isNaN(e[t])||(r=r>e[t]?e[t]:r,s=s>e[t]?s:e[t],a=a>e[t+1]?e[t+1]:a,l=l>e[t+1]?l:e[t+1]);const{cols:o,rows:c}=t,u=(s-r)/o/n[0],p=(l-a)/c/n[1],h=2*i;let f=0,d=!1,m=[0,0];for(let t=0;t<o-3;t++){for(let n=0;n<c-3;n++){const i=t*c*2+2*n,r=(e[i]+e[i+4]+e[i+4*c]+e[i+4*c+4])/4,s=(e[i+1]+e[i+5]+e[i+4*c+1]+e[i+4*c+5])/4,a=Math.abs((r-e[i+2*c+2])/u),l=Math.abs((s-e[i+2*c+3])/p);if(a+l>f&&(f=a+l,m=[a,l]),h&&f>h){d=!0;break}}if(d)break}return m},g={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},x=new Map,b=new Map,w=500;async function v(){(0,c.kR)()||await(0,c.zD)()}function R(e,t,n){return m(e.spatialReference,t)?n?(0,c.rS)(t,e.spatialReference,e):(0,c.rS)(e.spatialReference,t,e):null}function S(e,t,n,i=null){const r=e.spatialReference;if(r.equals(t))return e;m(r,t,i);const s=n.center,o=new u.Z({xmin:s.x-e.x/2,xmax:s.x+e.x/2,ymin:s.y-e.y/2,ymax:s.y+e.y/2,spatialReference:r}),p=(0,c.iV)(o,t,i),h=L(t);let f;if((0,a.Wi)(p)||(0,a.pC)(h)&&p.width>=h){const n=(0,l.c9)(r)/(0,l.c9)(t);f={x:e.x*n,y:e.y*n}}else f={x:p.width,y:p.height};return f}function C(e,t=.01){return(0,l.c9)(e)?t/(0,l.c9)(e):0}function _(e,t,n=null,i=!0){const r=e.spatialReference;if(r.equals(t))return e;m(r,t,n);const s=(0,c.iV)(e,t,n);return i&&s?(M([e],[s],r,t),s):s}function M(e,t,n,i){const r=W(n,!0),s=W(i,!0),l=C(n,w),o=C(i,w);if(l&&(0,a.pC)(r)&&(0,a.pC)(s))for(let n=0;n<e.length;n++){const i=t[n];if(!i)continue;const{x:a}=e[n],{x:c}=i;c>=s[1]-o&&Math.abs(a-r[0])<l?i.x-=s[1]-s[0]:c<=s[0]+o&&Math.abs(a-r[1])<l&&(i.x+=s[1]-s[0])}}function T(e){const{inSR:t,outSR:n,datumTransformation:i,preferPE:r}=e;if(t.equals(n)){const{points:t}=k(e,null);return t}if(t.isWebMercator&&n.isWGS84||t.isWGS84&&n.isWebMercator)return function(e){const{cols:t,rows:n,xres:i,yres:r,usePixelCenter:s,inSR:a,outSR:l}=e;let{xmin:o,ymax:u}=e;s&&(o+=i/2,u-=r/2);const h=[],f=[],d=Math.max(t,n);for(let e=0;e<d;e++){const s=o+i*Math.min(t,e),d=u-r*Math.min(n,e),m=(0,c.iV)(new p.Z({x:s,y:d,spatialReference:a}),l);e<=t&&h.push(m.x),e<=n&&f.push(m.y)}const m=[];for(let e=0;e<t;e++)for(let t=0;t<n;t++)m.push([h[e],f[t]]);return m}(e);if(m(t,n,i)&&r){if(t.isGeographic)return P(e);const n=E(t);if((0,a.pC)(n))return P(e)}return function(e){const{points:t}=k(e,null),{inSR:n,outSR:i,datumTransformation:r}=e,s=t.map((e=>new p.Z(e[0],e[1],n))),a=(0,c.iV)(s,i,r);return r&&M(s,a,n,i),a.map((e=>e?[e.x,e.y]:[NaN,NaN]))}(e)}function P(e){const{inSR:t,outSR:n,datumTransformation:i}=e,r=E(t),{points:s,mask:l}=k(e,r);if(!t.isGeographic){const e=t.wkid?o.e.coordsys(t.wkid):o.e.fromString(t.isGeographic?o.f.PE_TYPE_GEOGCS:o.f.PE_TYPE_PROJCS,t.wkt);o.g.projToGeog(e,s.length,s)}if((0,a.pC)(i)&&i.steps.length){let e;const t=179.9955;if(n.isGeographic&&(e=s.map((([e])=>e>t?1:e<-t?-1:0))),i.steps.forEach((e=>{const t=e.wkid?o.e.geogtran(e.wkid):o.e.fromString(o.f.PE_TYPE_GEOGTRAN,e.wkt);o.h.geogToGeog(t,s.length,s,null,e.isInverse?o.f.PE_TRANSFORM_2_TO_1:o.f.PE_TRANSFORM_1_TO_2)})),e)for(let n=0;n<s.length;n++){const i=e[n],r=s[n][0],a=r>t?1:r<-t?-1:0;i&&a&&i!==a&&(s[n][0]=i>0?r+360:r-360)}}if(!n.isGeographic){const e=E(n,!0),t=(0,a.pC)(e)&&e.isEnvelope?[e.bbox[1],e.bbox[3]]:[-90,90];!function(e,t){const[n,i]=t;for(let t=0;t<e.length;t++){const r=e[t][1];(r<n||r>i)&&(e[t]=[NaN,NaN])}}(s,t);const i=n.wkid?o.e.coordsys(n.wkid):o.e.fromString(n.isGeographic?o.f.PE_TYPE_GEOGCS:o.f.PE_TYPE_PROJCS,n.wkt);o.g.geogToProj(i,s.length,s)}let c=s;if(l&&s.length!==l.length){c=[];for(let e=0,t=0;e<l.length;e++)l[e]?c.push(s[t++]):c.push([NaN,NaN])}return c}function E(e,t=!1){let n=e.wkid||e.wkt;if(!n||e.isGeographic)return null;if(n=String(n),x.has(n)){const e=x.get(n);return t?e?.gcs:e?.pcs}const i=e.wkid?o.e.coordsys(e.wkid):o.e.fromString(e.isGeographic?o.f.PE_TYPE_GEOGCS:o.f.PE_TYPE_PROJCS,e.wkt),r=I(i,C(e,1e-4)),s=I(i,0,!0);return x.set(n,{pcs:r,gcs:s}),t?s:r}function I(e,t=0,n=!1){const i=o.j.generate(e),r=n?e.horizonGcsGenerate():e.horizonPcsGenerate();if(!i||!r?.length)return null;let s=!1,a=r.find((e=>1===e.getInclusive()&&1===e.getKind()));if(!a){if(a=r.find((e=>1===e.getInclusive()&&0===e.getKind())),!a)return null;s=!0}const l=n?0:(2===i.getNorthPoleLocation()?1:0)|(2===i.getSouthPoleLocation()?2:0),c=i.isPannableRectangle(),u=a.getCoord();if(s)return{isEnvelope:s,isPannable:c,vertices:u,coef:null,bbox:[u[0][0]-t,u[0][1]-t,u[1][0]+t,u[1][1]+t],poleLocation:l};let p=0;const h=[];let[f,d]=u[0],[m,y]=u[0];for(let e=0,t=u.length;e<t;e++){p++,p===t&&(p=0);const[n,i]=u[e],[r,s]=u[p];if(s===i)h.push([n,r,i,s,2]);else{const e=(r-n)/(s-i||1e-4),t=n-e*i;i<s?h.push([e,t,i,s,0]):h.push([e,t,s,i,1])}f=f<n?f:n,d=d<i?d:i,m=m>n?m:n,y=y>i?y:i}return{isEnvelope:!1,isPannable:c,vertices:u,coef:h,bbox:[f,d,m,y],poleLocation:l}}function k(e,t){const n=[],{cols:i,rows:r,xres:s,yres:l,usePixelCenter:o}=e;let{xmin:c,ymax:u}=e;if(o&&(c+=s/2,u-=l/2),(0,a.Wi)(t)){for(let e=0;e<i;e++)for(let t=0;t<r;t++)n.push([c+s*e,u-l*t]);return{points:n}}const p=new Uint8Array(i*r);if(t.isEnvelope){const{bbox:[e,a,o,h]}=t;for(let f=0,d=0;f<i;f++){const i=c+s*f,m=t.isPannable||i>=e&&i<=o;for(let e=0;e<r;e++,d++){const t=u-l*e;m&&t>=a&&t<=h&&(n.push([i,t]),p[d]=1)}}return{points:n,mask:p}}const h=t.coef,f=[];for(let e=0;e<r;e++){const t=u-l*e,n=[],i=[];for(let e=0;e<h.length;e++){const[r,s,a,l,o]=h[e];if(t===a&&a===l)n.push(r),n.push(s),i.push(2),i.push(2);else if(t>=a&&t<=l){const e=r*t+s;n.push(e),i.push(o)}}let r=n;if(n.length>2){let e=2===i[0]?0:i[0],t=n[0];r=[];for(let s=1;s<i.length;s++)2===i[s]&&s!==i.length-1||(i[s]!==e&&(r.push(0===e?Math.min(t,n[s-1]):Math.max(t,n[s-1])),e=i[s],t=n[s]),s===i.length-1&&r.push(0===i[s]?Math.min(t,n[s]):Math.max(t,n[s])));r.sort(((e,t)=>e-t))}else n[0]>n[1]&&(r=[n[1],n[0]]);f.push(r)}for(let e=0,t=0;e<i;e++){const i=c+s*e;for(let e=0;e<r;e++,t++){const r=u-l*e,s=f[e];if(2===s.length)i>=s[0]&&i<=s[1]&&(n.push([i,r]),p[t]=1);else if(s.length>2){let e=!1;for(let t=0;t<s.length;t+=2)if(i>=s[t]&&i<=s[t+1]){e=!0;break}e&&(n.push([i,r]),p[t]=1)}}}return{points:n,mask:p}}function O(e){const t=L(e[0].spatialReference);if(e.length<2||(0,a.Wi)(t))return e[0];let{xmin:n,xmax:i,ymin:r,ymax:s}=e[0];for(let n=1;n<e.length;n++){const a=e[n];i=a.xmax+t*n,r=Math.min(r,a.ymin),s=Math.max(s,a.ymax)}return new u.Z({xmin:n,xmax:i,ymin:r,ymax:s,spatialReference:e[0].spatialReference})}function G(e,t,n=null,r=!0){const s=e.spatialReference;if(s.equals(t))return e;const l=F(e),o=L(s,!0),p=L(t);if(0===l||(0,a.Wi)(o)||(0,a.Wi)(p)){const l=N(e,t,n,r);if((0,a.Wi)(o)&&(0,a.pC)(p)&&Math.abs(l.width-p)<C(t)&&(0,c.kR)()){const n=E(s);if((0,a.pC)(n)&&n.poleLocation===i.None&&e.width<(n.bbox[2]-n.bbox[0])/2)return function(e,t){const n=L(t);if((0,a.Wi)(n))return null;let{xmin:i,ymin:r,xmax:s,ymax:l}=e;const o=e.spatialReference,p=new h.Z({spatialReference:o,rings:[[[i,r],[s,r],[s,l],[i,l],[i,r]]]}),f=(0,c.iV)(p,t);if(2!==f.rings.length||!f.rings[0].length||!f.rings[1].length)return null;const{rings:d}=f,m=C(o),y=new u.Z({spatialReference:t});for(let e=0;e<2;e++){i=s=d[e][0][0],r=l=d[e][0][1];for(let t=0;t<d[e].length;t++)i=i>d[e][t][0]?d[e][t][0]:i,s=s<d[e][t][0]?d[e][t][0]:s,r=r>d[e][t][1]?d[e][t][1]:r,l=l<d[e][t][1]?d[e][t][1]:l;if(0===e)y.ymin=r,y.ymax=l,y.xmin=i,y.xmax=s;else if(y.ymin=Math.min(y.ymin,r),y.ymax=Math.max(y.ymax,l),Math.abs(s-n/2)<m)y.xmin=i,y.xmax=y.xmax+n;else{if(!(Math.abs(i+n/2)<m))return null;y.xmax=s+n}}return y}(e,t)||l}return l}const f=e.clone().normalize();if(1===f.length&&e.xmax<o&&e.xmax-o/2>C(s)){const{xmin:t,xmax:n}=e;for(let i=0;i<=l;i++){const r=0===i?t:-o/2,a=i===l?n-o*i:o/2;f[i]=new u.Z({xmin:r,xmax:a,ymin:e.ymin,ymax:e.ymax,spatialReference:s})}}return O(f.map((e=>N(e,t,n,r))).filter(a.pC))}function N(e,t,n=null,i=!0,r=!0){const s=e.spatialReference;if(s.equals(t)||!t)return e;m(s,t,n);const l=(0,c.iV)(e,t,n);if(r&&t.isWebMercator&&l&&(l.ymax=Math.min(20037508.342787,l.ymax),l.ymin=Math.max(-20037508.342787,l.ymin),l.ymin>=l.ymax))return null;if(!i||!l)return l;const o=W(s,!0),u=W(t,!0);if((0,a.Wi)(o)||(0,a.Wi)(u))return l;const h=C(s,.001),f=C(s,w),d=C(t,.001);if(Math.abs(l.xmin-u[0])<d&&Math.abs(l.xmax-u[1])<d){const i=Math.abs(e.xmin-o[0]),r=Math.abs(o[1]-e.xmax);if(i<h&&r>f){l.xmin=u[0];const i=[];i.push(new p.Z(e.xmax,e.ymin,s)),i.push(new p.Z(e.xmax,(e.ymin+e.ymax)/2,s)),i.push(new p.Z(e.xmax,e.ymax,s));const r=i.map((e=>_(e,t,n))).filter((e=>!isNaN(e?.x))).map((e=>e.x));l.xmax=Math.max.apply(null,r)}if(r<h&&i>f){l.xmax=u[1];const i=[];i.push(new p.Z(e.xmin,e.ymin,s)),i.push(new p.Z(e.xmin,(e.ymin+e.ymax)/2,s)),i.push(new p.Z(e.xmin,e.ymax,s));const r=i.map((e=>_(e,t,n))).filter((e=>!isNaN(e?.x))).map((e=>e.x));l.xmin=Math.min.apply(null,r)}}else{const e=C(t,.001);Math.abs(l.xmin-u[0])<e&&(l.xmin=u[0]),Math.abs(l.xmax-u[1])<e&&(l.xmax=u[1])}return l}function L(e,t=!1){if(!e)return null;const n=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*n:e.wkid&&e.isGeographic?360:2*g[e.wkid]||null}function W(e,t=!1){if(e.isGeographic)return[-180,180];const n=L(e,t);return(0,a.pC)(n)?[-n/2,n/2]:null}function z(e,t,n,i){let r=(e-t)/n;return r-Math.floor(r)!=0?r=Math.floor(r):i&&(r-=1),r}function F(e,t=!1){const n=L(e.spatialReference);if((0,a.Wi)(n))return 0;const i=t?0:-n/2,r=C(e.spatialReference),s=!t&&Math.abs(e.xmax-n/2)<r?n/2:e.xmax,l=!t&&Math.abs(e.xmin+n/2)<r?-n/2:e.xmin;return z(s,i,n,!0)-z(l,i,n,!1)}function Z(e){const t=e.storageInfo.origin.x,n=L(e.spatialReference,!0);if((0,a.Wi)(n))return{originX:t,halfWorldWidth:null,pyramidsInfo:null};const i=n/2,{nativePixelSize:r,storageInfo:s,extent:l}=e,{maximumPyramidLevel:o,blockWidth:c,pyramidScalingFactor:u}=s;let p=r.x;const h=[],f=(0,a.pC)(e.transform)&&"gcs-shift"===e.transform.type,d=t+(f?0:i),m=f?n-t:i-t;for(let e=0;e<=o;e++){const e=(l.xmax-t)/p/c,n=e-Math.floor(e)==0?e:Math.ceil(e),i=m/p/c,r=i-Math.floor(i)==0?i:Math.ceil(i),s=Math.floor(d/p/c),a=Math.round(d/p)%c,o=(c-Math.round(m/p)%c)%c;h.push({resolutionX:p,blockWidth:c,datsetColumnCount:n,worldColumnCountFromOrigin:r,leftMargin:a,rightPadding:o,originColumnOffset:s}),p*=u}return{originX:t,halfWorldWidth:i,pyramidsInfo:h,hasGCSSShiftTransform:f}}function j(e){const t=e.isAdaptive&&null==e.spacing;let n=e.spacing||[32,32],i=V(e),r={cols:i.size[0]+1,rows:i.size[1]+1};const s=i.outofBoundPointCount>0&&i.outofBoundPointCount<i.offsets.length/2;let l=i.outofBoundPointCount===i.offsets.length/2||t&&s?[0,0]:y(i.offsets,r,n,4);const c=(l[0]+l[1])/2,u=e.projectedExtent.spatialReference,p=e.srcBufferExtent.spatialReference;if(t&&(s||c>4)&&(d(u,p,e.datumTransformation)&&(u.isGeographic||(0,a.pC)(E(u))),n=[4,4],i=V({...e,spacing:n}),r={cols:i.size[0]+1,rows:i.size[1]+1},l=y(i.offsets,r,n,4)),i.error=l,n[0]>1&&(i.coefficients=q(i.offsets,r,s)),e.includeGCSGrid&&!u.isGeographic&&!u.isWebMercator)if(p.isGeographic)i.gcsGrid={offsets:i.offsets,coefficients:i.coefficients,spacing:n};else{const t=E(u);if((0,a.pC)(t)&&!t.isEnvelope){const t=function(e){if(!e||e.isGeographic)return e;const t=String(e.wkid||e.wkt);let n;return b.has(t)?n=b.get(t):(n=(e.wkid?o.e.coordsys(e.wkid):o.e.fromString(o.f.PE_TYPE_PROJCS,e.wkt)).getGeogcs().getCode(),b.set(t,n)),new f.Z({wkid:n})}(u),a=G(e.projectedExtent,t),{offsets:l}=V({...e,srcBufferExtent:a,spacing:n}),c=q(l,r,s);i.gcsGrid={offsets:l,coefficients:c,spacing:n}}}return i}function V(e){const{projectedExtent:t,srcBufferExtent:n,pixelSize:i,datumTransformation:r,rasterTransform:s}=e,l=t.spatialReference,o=n.spatialReference,c=m(l,o),{xmin:u,ymin:h,xmax:f,ymax:d}=t,y=L(o),g=(0,a.pC)(y)&&(e.hasWrapAround||"gcs-shift"===s?.type),x=e.spacing||[32,32],b=x[0]*i.x,v=x[1]*i.y,R=1===x[0],S=Math.ceil((f-u)/b-.1/x[0])+(R?0:1),_=Math.ceil((d-h)/v-.1/x[1])+(R?0:1),M=T({cols:S,rows:_,xmin:u,ymax:d,xres:b,yres:v,inSR:l,outSR:o,datumTransformation:r,preferPE:x[0]<=4,usePixelCenter:R}),P=[];let I,k=0;const O=R?-1:NaN,{xmin:G,xmax:N,ymax:W,width:z,height:F}=n,Z=C(o,w),j=(0,a.pC)(y)&&G>0&&N>y/2;let V=!1;if(c){const e=E(l);V=(0,a.pC)(e)&&e.poleLocation>0}for(let e=0;e<S;e++){const t=[];for(let n=0;n<_;n++){let i=M[e*_+n];if(g&&i[0]>N&&i[0]>y/2-Z?i[0]-=y:g&&0===e&&i[0]<0&&j&&!s&&(i[0]+=y),!i||isNaN(i[0])||isNaN(i[1]))P.push(O),P.push(O),t.push(null),k++;else{if(s){const e=s.inverseTransform(new p.Z({x:i[0],y:i[1],spatialReference:o}));i=[e.x,e.y]}t.push(i),e>0&&g&&I[n]&&i[0]<I[n][0]&&(i[0]+=y,V&&i[0]>N&&i[0]>y&&(i[0]-=y)),P.push((i[0]-G)/z),P.push((W-i[1])/F)}}I=t}return{offsets:P,error:null,coefficients:null,outofBoundPointCount:k,spacing:x,size:R?[S,_]:[S-1,_-1]}}function q(e,t,n){const{cols:i,rows:r}=t,s=new Float32Array((i-1)*(r-1)*2*6),a=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),l=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let t=0;t<i-1;t++){for(let n=0;n<r-1;n++){let o=t*r*2+2*n;const c=e[o],u=e[o+1],p=e[o+2],h=e[o+3];o+=2*r;const f=e[o],d=e[o+1],m=e[o+2],y=e[o+3];let g=0,x=12*(n*(i-1)+t);for(let e=0;e<3;e++)s[x++]=a[g++]*c+a[g++]*p+a[g++]*m;g=0;for(let e=0;e<3;e++)s[x++]=a[g++]*u+a[g++]*h+a[g++]*y;g=0;for(let e=0;e<3;e++)s[x++]=l[g++]*c+l[g++]*f+l[g++]*m;g=0;for(let e=0;e<3;e++)s[x++]=l[g++]*u+l[g++]*d+l[g++]*y}if(n)for(let e=0;e<s.length;e++)isNaN(s[e])&&(s[e]=-1)}return s}function A(e){const t=e.clone().normalize();return 1===t.length?t[0]:O(t)}function B(e,t,n){const{storageInfo:i,pixelSize:r}=t;let s=0,o=!1;const{pyramidResolutions:c}=i;if((0,a.pC)(c)&&c.length){const i=(e.x+e.y)/2,a=c[c.length-1],u=(a.x+a.y)/2,h=(r.x+r.y)/2;if(i<=h)s=0;else if(i>=u)s=c.length,o=i/u>8;else{let e,t=h;for(let r=1;r<=c.length;r++){if(e=(c[r-1].x+c[r-1].y)/2,i<=e){i===e?s=r:"down"===n?(s=r-1,o=i/t>8):s="up"===n||i-t>e-i||i/t>2?r:r-1;break}t=e}}const f=0===s?r:c[s-1];return o&&Math.min(f.x,f.y)*(0,l.c9)(t.spatialReference)>19567&&(o=!1),{pyramidLevel:s,pyramidResolution:new p.Z({x:f.x,y:f.y,spatialReference:t.spatialReference}),excessiveReading:o}}const u=Math.log(e.x/r.x)/Math.LN2,h=Math.log(e.y/r.y)/Math.LN2,f=t.storageInfo.maximumPyramidLevel||0;s="down"===n?Math.floor(Math.min(u,h)):"up"===n?Math.ceil(Math.max(u,h)):Math.round((u+h)/2),s<0?s=0:s>f&&(o=s>f+3,s=f);const d=2**s;return{pyramidLevel:s,pyramidResolution:new p.Z({x:d*t.nativePixelSize.x,y:d*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:o}}},10:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var i=n(36663),r=n(70375),s=n(61681),a=n(76868),l=n(81977),o=(n(7753),n(7283),n(40266)),c=n(19654),u=n(8712),p=n(47071),h=n(80085),f=n(51599),d=n(18486),m=n(59439);const y=e=>{let t=class extends e{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return(0,d._D)((0,s.Wg)(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(e){return!!this.projectFullExtent(e)}projectFullExtent(e){const t=(0,s.Wg)(this.layer.fullExtent),n=(0,d._D)(t,e,!1);return(0,d.tB)(t,e,n)}async fetchPopupFeatures(e,t){const{layer:n}=this;if(!e)throw new r.Z("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:n});const{popupEnabled:i}=n,a=(0,m.V)(n,t);if(!i||(0,s.Wi)(a))throw new r.Z("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:i,popupTemplate:a});const l=[],{value:o,magdirValue:c}=await n.identify(e,{timeExtent:this.timeExtent});let u="";if(o&&o.length){u="imagery-tile"===n.type&&n.hasStandardTime()&&null!=o[0]?o.map((e=>n.getStandardTimeValue(e))).join(", "):o.join(", ");const e={ObjectId:0};e["Raster.ServicePixelValue"]=u;const t=n.rasterInfo.attributeTable;if((0,s.pC)(t)){const{fields:n,features:i}=t,r=n.find((({name:e})=>"value"===e.toLowerCase())),s=r?i.find((e=>String(e.attributes[r.name])===u)):null;if(s)for(const t in s.attributes)s.attributes.hasOwnProperty(t)&&(e[this._rasterFieldPrefix+t]=s.attributes[t])}const i=n.rasterInfo.dataType;"vector-magdir"!==i&&"vector-uv"!==i||(e["Raster.Magnitude"]=c?.[0],e["Raster.Direction"]=c?.[1]);const r=new h.Z(this.fullExtent.clone(),null,e);r.layer=n,r.sourceLayer=r.layer,l.push(r)}return l}};return(0,i._)([(0,l.Cb)()],t.prototype,"layer",void 0),(0,i._)([(0,l.Cb)(f.qG)],t.prototype,"timeExtent",void 0),(0,i._)([(0,l.Cb)()],t.prototype,"view",void 0),(0,i._)([(0,l.Cb)()],t.prototype,"fullExtent",null),(0,i._)([(0,l.Cb)()],t.prototype,"tileInfo",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],t.prototype,"hasTilingEffects",null),t=(0,i._)([(0,o.j)("esri.views.layers.ImageryTileLayerView")],t),t};var g=n(26216),x=n(55068),b=n(99621),w=n(35119);let v=class extends(y((0,x.Z)((0,u.r)((0,c.A)(g.Z))))){constructor(){super(...arguments),this.type="imagery-tile-3d",this.isAlignedMapTile=!0}initialize(){this.layer.increaseRasterJobHandlerUsage(),null==this.fullExtent&&this.addResolvingPromise(Promise.reject(new r.Z("layerview:spatial-reference-incompatible","The layer extent cannot be projected to the view's spatial reference",{layer:this.layer})));const e=(0,a.N1)((()=>this.view?.basemapTerrain?.tilingSchemeLocked)).then((()=>{const e=this.view.basemapTerrain.tilingScheme,{tileInfo:t}=this.layer,n=["png","png24","png32","jpg","mixed"].includes(t.format)&&e.compatibleWith(t);this.isAlignedMapTile=n;const i=n?t:e.toTileInfo();this.tileInfo=i,this.updatingHandles.add((()=>[this.layer.renderer,this.layer.interpolation,this.layer.bandIds,this.layer.multidimensionalDefinition,this.layer.multidimensionalSubset,this.layer.rasterFunction]),(()=>this.refresh()))}));this.addResolvingPromise(e)}destroy(){this.layer.decreaseRasterJobHandlerUsage(),this.view=null}get _blankTile(){const e=document.createElement("canvas"),t=e.getContext("2d"),[n,i]=this.tileInfo.size;return e.width=n,e.height=i,t.clearRect(0,0,n,i),t.getImageData(0,0,n,i)}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get dataLevelRange(){const e=this.tileInfo.lods,t=this.layer.tileInfo.lods,n=e[0].scale,i=t[t.length-1].scale;return this.levelRangeFromScaleRange(n,i)}_getfullExtent(){return this.projectFullExtent(this.view.basemapTerrain&&(0,s.pC)(this.view.basemapTerrain.spatialReference)?this.view.basemapTerrain.spatialReference:this.view.spatialReference)}async fetchTile(e,t,n,i){const r=this.tileInfo,a=this._canSymbolizeInWebGL(),l={tileInfo:r,requestRawData:a,signal:(0,s.Wg)(i.signal),requestAsImageElement:this.isAlignedMapTile},o=await this.layer.fetchTile(e,t,n,l);if(o instanceof HTMLImageElement)return o;let c=o&&o.pixelBlock;if((0,s.Wi)(c))return this._blankTile;if(!a&&(c=await this.layer.applyRenderer(o),(0,s.Wi)(c)))return this._blankTile;const u=new p.H([e,t,n],c,r.size[0],r.size[1]);return a?(u.symbolizerRenderer=this.layer.symbolizer.rendererJSON,u.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e)),u.transformGrid=o.transformGrid):u.isRendereredSource=!0,u.interpolation=this.layer.interpolation,u.bandIds=this.layer.bandIds,u}_getSymbolizerOptions(e){const t=this.tileInfo.lodAt(e).resolution;return{pixelBlock:null,isGCS:this.view.basemapTerrain&&(0,s.pC)(this.view.basemapTerrain.spatialReference)?this.view.basemapTerrain.spatialReference.isGeographic:this.view.spatialReference.isGeographic,resolution:{x:t,y:t},bandIds:this.layer.bandIds}}ensureSymbolizerParameters(e){this._canSymbolizeInWebGL()&&JSON.stringify(e.symbolizerRenderer)!==JSON.stringify(this.layer.symbolizer.rendererJSON)&&(e.symbolizerParameters=this.layer.symbolizer.generateWebGLParameters(this._getSymbolizerOptions(e.lij[0])))}createFetchPopupFeaturesQueryGeometry(e,t){return(0,b.K)(e,t,this.view)}refresh(){this.emit("data-changed")}async doRefresh(){this.suspended||this.emit("data-changed")}_canSymbolizeInWebGL(){return(0,w.hc)("3d").supportsTextureFloat&&this.layer.symbolizer.canRenderInWebGL}};(0,i._)([(0,l.Cb)({readOnly:!0})],v.prototype,"_blankTile",null),(0,i._)([(0,l.Cb)({readOnly:!0})],v.prototype,"imageFormatIsOpaque",null),(0,i._)([(0,l.Cb)({readOnly:!0})],v.prototype,"hasMixedImageFormats",null),(0,i._)([(0,l.Cb)({readOnly:!0})],v.prototype,"dataLevelRange",null),v=(0,i._)([(0,o.j)("esri.views.3d.layers.ImageryTileLayerView3D")],v);const R=v},19654:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(36663),r=n(23148),s=n(78668),a=n(76868),l=n(81977),o=(n(7753),n(7283),n(40266)),c=n(64862);const u=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(e){super.postscript(e),(0,c.qC)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.handles.add((0,r.kB)((()=>e.abort()))),await(0,a.N1)((()=>this.view.defaultsFromMap?.heightModelInfoReady),t),(0,s.k_)(t);const n=(0,c.Wt)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(n)throw n}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}getSuspendInfo(){const e=super.getSuspendInfo(),t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return t&&t.minScale&&t.maxScale&&t.minScale<t.maxScale&&(e.outsideScaleRange=!0),e}};return(0,i._)([(0,l.Cb)()],t.prototype,"view",void 0),(0,i._)([(0,l.Cb)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,i._)([(0,o.j)("esri.views.3d.layers.LayerView3D")],t),t}},8712:(e,t,n)=>{n.d(t,{r:()=>p});var i=n(36663),r=n(70375),s=n(61681),a=n(76868),l=n(81977),o=(n(7753),n(7283),n(40266)),c=n(57686),u=n(13809);const p=e=>{let t=class extends e{get imageFormatIsOpaque(){return!1}get fullExtent(){return this.layer.fullExtent}get isOpaque(){return this.fullOpacity>=1&&this.imageFormatIsOpaque}get dataLevelRange(){const e=this.tileInfo.lods,t=e[0].scale,n=e[e.length-1].scale;return this.levelRangeFromScaleRange(t,n)}get displayLevelRange(){const e=this.tileInfo.lods,t=this.layer.minScale||e[0].scale,n=this.layer.maxScale||e[e.length-1].scale,i=this.levelRangeFromScaleRange(t,n);return this.layer.maxScale&&i.maxLevel++,i}getTileUrl(e,t,n){return this.layer.getTileUrl(e,t,n)}_addTilingSchemeMatchPromise(){if((0,s.Wi)(this.fullExtent))return this.addResolvingPromise(Promise.reject(new r.Z("tilingscheme:extent-not-defined","This layer doesn't define a fullExtent.")));const e=this._getTileInfoSupportError(this.tileInfo,this.fullExtent);if((0,s.pC)(e))return this.addResolvingPromise(Promise.reject(e));const t=(0,a.N1)((()=>this.view?.basemapTerrain?.tilingSchemeLocked)).then((()=>{const e=this.view.basemapTerrain.tilingScheme,t=this._getTileInfoCompatibilityError(this.tileInfo,e);if(t)throw t}));this.addResolvingPromise(t)}_getTileInfoSupportError(e,t){const n=(0,u.er)(e,t,this.view.spatialReference,this.view.state.viewingMode);if(n){const e={layer:this.layer,error:n};let t;switch(n.name){case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":case"tilingscheme:local-unsupported-spatial-reference":t=new r.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",e);break;default:t=new r.Z("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",e)}return t}return null}_getTileInfoCompatibilityError(e,t){return t.compatibleWith(e)?null:new r.Z("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")}levelRangeFromScaleRange(e,t){const n={minLevel:0,maxLevel:1/0},i=this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.tilingScheme;if(!i)return n;const r=i.levels[0],s=e=>{const t=Math.log(r.scale/e)/Math.LN2;return.5-Math.abs(.5-t%1)<1e-9?Math.round(t):Math.ceil(t)};return null!=e&&e>0&&(n.minLevel=Math.max(0,s(e))),null!=t&&t>0&&(n.maxLevel=Math.max(0,s(t))),n}isUpdating(){return!!(this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.updating)}};return(0,i._)([(0,l.Cb)({readOnly:!0})],t.prototype,"imageFormatIsOpaque",null),(0,i._)([(0,l.Cb)({readOnly:!0})],t.prototype,"updating",void 0),(0,i._)([(0,l.Cb)(c.q)],t.prototype,"updatingProgress",void 0),(0,i._)([(0,l.Cb)(c.V)],t.prototype,"updatingProgressValue",void 0),(0,i._)([(0,l.Cb)()],t.prototype,"fullExtent",null),(0,i._)([(0,l.Cb)({readOnly:!0})],t.prototype,"isOpaque",null),(0,i._)([(0,l.Cb)({readOnly:!0})],t.prototype,"dataLevelRange",null),(0,i._)([(0,l.Cb)({readOnly:!0})],t.prototype,"displayLevelRange",null),(0,i._)([(0,l.Cb)()],t.prototype,"layer",void 0),(0,i._)([(0,l.Cb)()],t.prototype,"tileInfo",void 0),t=(0,i._)([(0,o.j)("esri.views.3d.layers.TiledLayerView3D")],t),t}},26216:(e,t,n)=>{n.d(t,{Z:()=>d});var i=n(36663),r=n(53443),s=n(31355),a=n(53280),l=n(86618),o=n(13802),c=n(61681),u=n(64189),p=n(81977),h=(n(7753),n(7283),n(40266));let f=class extends((0,a.p)((0,l.IG)((0,u.v)(s.Z.EventedMixin(r.Z))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",n=this.layer&&this.layer.title||"no title";o.Z.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${n}', id: '${t}')`,e)}}))}get fullOpacity(){return(0,c.Pt)(this.get("layer.opacity"),1)*(0,c.Pt)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,i._)([(0,p.Cb)()],f.prototype,"fullOpacity",null),(0,i._)([(0,p.Cb)()],f.prototype,"layer",void 0),(0,i._)([(0,p.Cb)()],f.prototype,"parent",void 0),(0,i._)([(0,p.Cb)({readOnly:!0})],f.prototype,"suspended",null),(0,i._)([(0,p.Cb)({readOnly:!0})],f.prototype,"suspendInfo",null),(0,i._)([(0,p.Cb)({readOnly:!0})],f.prototype,"legendEnabled",null),(0,i._)([(0,p.Cb)({type:Boolean,readOnly:!0})],f.prototype,"updating",null),(0,i._)([(0,p.Cb)({readOnly:!0})],f.prototype,"updatingProgress",null),(0,i._)([(0,p.Cb)()],f.prototype,"visible",null),(0,i._)([(0,p.Cb)()],f.prototype,"view",void 0),f=(0,i._)([(0,h.j)("esri.views.layers.LayerView")],f);const d=f},55068:(e,t,n)=>{n.d(t,{Z:()=>c});var i=n(36663),r=n(13802),s=n(78668),a=n(76868),l=n(81977),o=(n(7753),n(7283),n(40266));const c=e=>{let t=class extends e{initialize(){this.handles.add((0,a.on)((()=>this.layer),"refresh",(e=>{this.doRefresh(e.dataChanged).catch((e=>{(0,s.D_)(e)||r.Z.getLogger(this.declaredClass).error(e)}))})),"RefreshableLayerView")}};return(0,i._)([(0,l.Cb)()],t.prototype,"layer",void 0),t=(0,i._)([(0,o.j)("esri.layers.mixins.RefreshableLayerView")],t),t}},59439:(e,t,n)=>{n.d(t,{V:()=>a,e:()=>s});var i=n(61681),r=n(14845);async function s(e,t=e.popupTemplate){if((0,i.Wi)(t))return[];const n=await t.getRequiredFields(e.fieldsIndex),{lastEditInfoEnabled:s}=t,{objectIdField:a,typeIdField:l,globalIdField:o,relationships:c}=e;if(n.includes("*"))return["*"];const u=s?await(0,r.CH)(e):[],p=(0,r.Q0)(e.fieldsIndex,[...n,...u]);return l&&p.push(l),p&&a&&e.fieldsIndex.has(a)&&!p.includes(a)&&p.push(a),p&&o&&e.fieldsIndex.has(o)&&!p.includes(o)&&p.push(o),c&&c.forEach((t=>{const{keyField:n}=t;p&&n&&e.fieldsIndex.has(n)&&!p.includes(n)&&p.push(n)})),p}function a(e,t){return e.popupTemplate?e.popupTemplate:(0,i.pC)(t)&&t.defaultPopupTemplateEnabled&&(0,i.pC)(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}},99621:(e,t,n)=>{n.d(t,{K:()=>a}),n(91957);var i=n(61681),r=n(17321),s=n(91772);function a(e,t,n,a=new s.Z){let l;if("2d"===n.type)l=t*n.resolution;else if("3d"===n.type){const s=n.overlayPixelSizeInMapUnits(e),a=n.basemapSpatialReference;l=(0,i.pC)(a)&&!a.equals(n.spatialReference)?(0,r.c9)(a)/(0,r.c9)(n.spatialReference):t*s}const o=e.x-l,c=e.y-l,u=e.x+l,p=e.y+l,{spatialReference:h}=n;return a.xmin=Math.min(o,u),a.ymin=Math.min(c,p),a.xmax=Math.max(o,u),a.ymax=Math.max(c,p),a.spatialReference=h,a}new s.Z}}]);